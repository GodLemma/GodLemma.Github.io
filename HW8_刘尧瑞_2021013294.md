### 3.利用我们以上介绍的方法和数据，分别使用DESeq2和edgeR找出uvr8突变型（uvr8）在光照前后的差异基因，保存为文本文件。

输出文件见文件夹。使用DESeq2的结果为wt.light.vs.dark.all.txt,使用edgeR的结果为edger.wt.light.vs.dark.all.txt。

---
### 4.对于uvr8突变型的差异基因，定义|log2FC|>1，FDR<0.05的基因为差异表达基因。比较两个软件得到的差异基因有多少是重合的，有多少是不同的，用venn图的形式展示。

**code：**
```R
library("VennDiagram")
deseq2.table = read.table("C:\\Users\\86135\\Desktop\\wt.light.vs.dark.txt",sep = '\t',header = T)
edger.table = read.table("C:\\Users\\86135\\Desktop\\edger.wt.light.vs.dark.txt",sep = '\t',header = T)
venn.diagram(list(DESeq2 = rownames(deseq2.table),edgeR = rownames(edger.table)),fill = c("red","green"),cex = 1.5,filename = "deseq2.vs.edger.venn.png")
```
结果如下：

![deseq2 vs edger venn](https://github.com/GodLemma/Bioinformatics/assets/162097106/ac2ce73e-79c0-4be5-b5bb-60768e541b5b)

---
### 5.对于edgeR找出的FDR<0.05的基因，选出log2FoldChange最大的10个基因和最小的10个基因。计算原始表达量矩阵的log10CPM值并对每个基因进行Z-score处理，使用刚才筛选出来的20个基因绘制热图（heatmap）作为最后结果输出。

**code:**
```R
#以下代码添加在edgeR做差异分析的代码之后即可
diff.table.filtered <- diff.table[diff.table$FDR < 0.05,]
raw.counts <- read.table("C:\\Users\\86135\\Desktop\\count_exon.txt", sep='\t', header = T,row.names = 1)
edger.seq.table = diff.table.filtered[order(-diff.table.filtered$logFC),]
sort.gene = c(head(rownames(edger.seq.table),10),tail(rownames(edger.seq.table),10))
sort.counts = raw.counts[sort.gene,]
```
